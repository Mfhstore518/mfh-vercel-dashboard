<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MFH STORE - Admin Dashboard</title>
    <style>
        :root {
            --primary: #0066ff;
            --secondary: #8a2be2;
            --danger: #ff4444;
            --success: #00ffaa;
            --warning: #ffcc00;
            --bg-dark: #0a0a1a;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: var(--bg-dark);
            color: white;
            min-height: 100vh;
        }
        
        /* LOGIN PAGE */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
        }
        
        .login-box {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 20px;
            padding: 40px;
            width: 100%;
            max-width: 400px;
            text-align: center;
        }
        
        .login-box h1 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.8rem;
        }
        
        .login-box p {
            color: #aaa;
            margin-bottom: 30px;
            font-size: 0.9rem;
        }
        
        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #ccc;
            font-size: 0.9rem;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 10px;
            color: white;
            font-size: 1rem;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        .btn {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            font-size: 1rem;
            transition: 0.3s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,102,255,0.3);
        }
        
        /* DASHBOARD LAYOUT */
        .dashboard-layout {
            display: none;
        }
        
        /* HEADER */
        .dashboard-header {
            background: rgba(0,0,0,0.3);
            backdrop-filter: blur(10px);
            padding: 15px 25px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .role-badge {
            background: rgba(0,102,255,0.2);
            color: var(--primary);
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        /* SIDEBAR */
        .sidebar {
            width: 250px;
            background: rgba(0,0,0,0.2);
            height: calc(100vh - 70px);
            position: fixed;
            left: 0;
            padding: 20px 0;
            border-right: 1px solid rgba(255,255,255,0.1);
        }
        
        .menu-section {
            margin-bottom: 30px;
        }
        
        .menu-title {
            color: #666;
            font-size: 0.8rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            padding: 0 20px 10px;
        }
        
        .menu-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            color: #ccc;
            text-decoration: none;
            transition: 0.3s;
            border-left: 3px solid transparent;
            cursor: pointer;
        }
        
        .menu-item:hover, .menu-item.active {
            background: rgba(0,102,255,0.1);
            color: white;
            border-left-color: var(--primary);
        }
        
        /* MAIN CONTENT */
        .main-content {
            margin-left: 250px;
            padding: 20px;
            min-height: calc(100vh - 70px);
        }
        
        .page {
            display: none;
        }
        
        .page.active {
            display: block;
        }
        
        /* STATS GRID */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: rgba(255,255,255,0.05);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            margin: 10px 0;
            color: var(--primary);
        }
        
        /* TABLES */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: rgba(255,255,255,0.05);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .data-table th, .data-table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .data-table th {
            background: rgba(0,0,0,0.3);
            color: var(--primary);
            font-weight: 600;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            display: inline-block;
        }
        
        .status-pending { background: rgba(255,68,68,0.2); color: var(--danger); }
        .status-processing { background: rgba(255,204,0,0.2); color: var(--warning); }
        .status-completed { background: rgba(0,255,170,0.2); color: var(--success); }
        
        /* MODALS */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: var(--bg-dark);
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 500px;
            border: 1px solid var(--primary);
        }
        
        /* NOTIFICATIONS */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            z-index: 2000;
            animation: slideIn 0.3s;
            max-width: 300px;
        }
        
        .notification.success {
            background: linear-gradient(45deg, var(--success), #00cc88);
        }
        
        .notification.error {
            background: linear-gradient(45deg, var(--danger), #ff6666);
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        /* RESPONSIVE */
        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
            }
            
            .sidebar .menu-text {
                display: none;
            }
            
            .main-content {
                margin-left: 70px;
            }
            
            .login-box {
                padding: 30px 20px;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- LOGIN PAGE -->
    <div id="loginPage" class="login-container">
        <div class="login-box">
            <h1><i class="fas fa-store"></i> MFH ADMIN</h1>
            <p>Login untuk mengakses dashboard</p>
            
            <div class="form-group">
                <label>Username</label>
                <input type="text" id="loginUsername" class="form-control" placeholder="admin">
            </div>
            
            <div class="form-group">
                <label>Password</label>
                <input type="password" id="loginPassword" class="form-control" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
            </div>
            
            <div style="background: rgba(0,102,255,0.1); padding: 15px; border-radius: 10px; margin-bottom: 20px;">
                <p style="font-size: 0.9rem; color: #aaa; margin-bottom: 5px;">Demo Accounts:</p>
                <p style="font-size: 0.8rem; color: #888;">Admin: admin / admin123</p>
                <p style="font-size: 0.8rem; color: #888;">Seller: seller1 / seller123</p>
            </div>
            
            <button class="btn" onclick="login()">
                <i class="fas fa-sign-in-alt"></i> LOGIN
            </button>
        </div>
    </div>
    
    <!-- DASHBOARD LAYOUT -->
    <div id="dashboardLayout" class="dashboard-layout">
        <!-- HEADER -->
        <div class="dashboard-header">
            <div class="logo">
                <i class="fas fa-store"></i>
                <span>MFH STORE DASHBOARD</span>
            </div>
            
            <div class="user-info">
                <div class="role-badge" id="userRole">Admin</div>
                <div>
                    <div style="font-weight: bold;" id="userName">Admin</div>
                    <div style="font-size: 0.8rem; color: #aaa;" id="userShop">MFH Store</div>
                </div>
                <button class="btn" onclick="logout()" style="padding: 8px 15px; font-size: 0.9rem;">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>
        
        <!-- SIDEBAR -->
        <div class="sidebar">
            <!-- Admin Menu -->
            <div id="adminMenu" class="menu-section">
                <div class="menu-title">Admin Controls</div>
                <div class="menu-item active" onclick="showPage('dashboard')">
                    <i class="fas fa-tachometer-alt"></i>
                    <span class="menu-text">Dashboard</span>
                </div>
                <div class="menu-item" onclick="showPage('users')">
                    <i class="fas fa-users"></i>
                    <span class="menu-text">Manage Users</span>
                </div>
                <div class="menu-item" onclick="showPage('orders')">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="menu-text">Orders</span>
                </div>
                <div class="menu-item" onclick="showPage('settings')">
                    <i class="fas fa-cog"></i>
                    <span class="menu-text">Settings</span>
                </div>
            </div>
            
            <!-- Seller Menu -->
            <div id="sellerMenu" class="menu-section" style="display: none;">
                <div class="menu-title">Seller Menu</div>
                <div class="menu-item active" onclick="showPage('sellerDashboard')">
                    <i class="fas fa-tachometer-alt"></i>
                    <span class="menu-text">My Dashboard</span>
                </div>
                <div class="menu-item" onclick="showPage('myOrders')">
                    <i class="fas fa-shopping-cart"></i>
                    <span class="menu-text">My Orders</span>
                </div>
                <div class="menu-item" onclick="showPage('profile')">
                    <i class="fas fa-user"></i>
                    <span class="menu-text">My Profile</span>
                </div>
            </div>
            
            <!-- Account -->
            <div class="menu-section">
                <div class="menu-title">Account</div>
                <div class="menu-item" onclick="showModal('changePasswordModal')">
                    <i class="fas fa-key"></i>
                    <span class="menu-text">Change Password</span>
                </div>
            </div>
        </div>
        
        <!-- MAIN CONTENT -->
        <div class="main-content">
            <!-- DASHBOARD PAGE -->
            <div id="dashboardPage" class="page active">
                <h1 style="margin-bottom: 20px;">üìä Admin Dashboard</h1>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div style="color: #aaa; font-size: 0.9rem;">Total Orders</div>
                        <div class="stat-value" id="totalOrders">0</div>
                        <div style="color: #666; font-size: 0.8rem;">Today: <span id="todayOrders">0</span></div>
                    </div>
                    
                    <div class="stat-card">
                        <div style="color: #aaa; font-size: 0.9rem;">Total Revenue</div>
                        <div class="stat-value" id="totalRevenue">Rp 0</div>
                        <div style="color: #666; font-size: 0.8rem;">Today: <span id="todayRevenue">Rp 0</span></div>
                    </div>
                    
                    <div class="stat-card">
                        <div style="color: #aaa; font-size: 0.9rem;">Active Sellers</div>
                        <div class="stat-value" id="totalSellers">0</div>
                        <div style="color: #666; font-size: 0.8rem;">Online: <span id="onlineSellers">0</span></div>
                    </div>
                    
                    <div class="stat-card">
                        <div style="color: #aaa; font-size: 0.9rem;">Products</div>
                        <div class="stat-value" id="totalProducts">0</div>
                        <div style="color: #666; font-size: 0.8rem;">Active: <span id="activeProducts">0</span></div>
                    </div>
                </div>
                
                <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 30px; margin-top: 40px;">
                    <!-- Recent Orders -->
                    <div>
                        <h3 style="margin-bottom: 15px;">Recent Orders</h3>
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Order ID</th>
                                    <th>Customer</th>
                                    <th>Amount</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody id="recentOrdersTable">
                                <!-- Data akan diisi oleh JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    
                    <!-- Quick Actions -->
                    <div>
                        <h3 style="margin-bottom: 15px;">Quick Actions</h3>
                        <div style="display: flex; flex-direction: column; gap: 10px;">
                            <button class="btn" onclick="showPage('users')">
                                <i class="fas fa-user-plus"></i> Add Seller
                            </button>
                            <button class="btn" onclick="showModal('addOrderModal')">
                                <i class="fas fa-plus"></i> Create Order
                            </button>
                            <button class="btn" onclick="showPage('settings')">
                                <i class="fas fa-cog"></i> Settings
                            </button>
                        </div>
                        
                        <!-- Webstore Status -->
                        <div style="margin-top: 30px; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 10px;">
                            <h4 style="margin-bottom: 10px;">üåê Webstore Status</h4>
                            <p style="margin-bottom: 10px;">Connected: <span id="webstoreStatus" style="color: var(--success);">Online</span></p>
                            <p style="font-size: 0.9rem; color: #aaa;">Orders will sync automatically</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- USERS MANAGEMENT PAGE -->
            <div id="usersPage" class="page">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h1>üë• User Management</h1>
                    <button class="btn" onclick="showModal('addUserModal')">
                        <i class="fas fa-plus"></i> Add New User
                    </button>
                </div>
                
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>Username</th>
                            <th>Role</th>
                            <th>Shop Name</th>
                            <th>Phone</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="usersTable">
                        <!-- Data akan diisi oleh JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <!-- ORDERS PAGE -->
            <div id="ordersPage" class="page">
                <h1 style="margin-bottom: 20px;">üì¶ Order Management</h1>
                
                <div style="margin-bottom: 20px; display: flex; gap: 10px;">
                    <button class="btn" onclick="loadOrders('all')">All Orders</button>
                    <button class="btn" onclick="loadOrders('pending')">Pending</button>
                    <button class="btn" onclick="loadOrders('completed')">Completed</button>
                </div>
                
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Order ID</th>
                            <th>Customer</th>
                            <th>Product</th>
                            <th>Amount</th>
                            <th>Status</th>
                            <th>Date</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="ordersTable">
                        <!-- Data akan diisi oleh JavaScript -->
                    </tbody>
                </table>
            </div>
            
            <!-- SELLER DASHBOARD PAGE -->
            <div id="sellerDashboardPage" class="page">
                <h1 style="margin-bottom: 20px;">üìä Seller Dashboard</h1>
                
                <div class="stats-grid">
                    <div class="stat-card">
                        <div style="color: #aaa; font-size: 0.9rem;">My Orders</div>
                        <div class="stat-value" id="sellerOrders">0</div>
                        <div style="color: #666; font-size: 0.8rem;">Pending: <span id="sellerPending">0</span></div>
                    </div>
                    
                    <div class="stat-card">
                        <div style="color: #aaa; font-size: 0.9rem;">My Revenue</div>
                        <div class="stat-value" id="sellerRevenue">Rp 0</div>
                        <div style="color: #666; font-size: 0.8rem;">Today: <span id="sellerTodayRevenue">Rp 0</span></div>
                    </div>
                </div>
                
                <div style="margin-top: 30px;">
                    <h3 style="margin-bottom: 15px;">My Recent Orders</h3>
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Order ID</th>
                                <th>Customer</th>
                                <th>Product</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="sellerOrdersTable">
                            <!-- Data akan diisi oleh JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
            
            <!-- SETTINGS PAGE -->
            <div id="settingsPage" class="page">
                <h1 style="margin-bottom: 20px;">‚öôÔ∏è System Settings</h1>
                
                <div style="max-width: 600px;">
                    <div style="background: rgba(255,255,255,0.05); padding: 25px; border-radius: 15px; margin-bottom: 20px;">
                        <h3 style="margin-bottom: 15px;">Store Information</h3>
                        
                        <div class="form-group">
                            <label>Store Name</label>
                            <input type="text" class="form-control" id="storeName" value="MFH STORE ID">
                        </div>
                        
                        <div class="form-group">
                            <label>Store Phone</label>
                            <input type="text" class="form-control" id="storePhone" value="081998593873">
                        </div>
                        
                        <div class="form-group">
                            <label>Store Email</label>
                            <input type="email" class="form-control" id="storeEmail" value="admin@mfhstore.id">
                        </div>
                    </div>
                    
                    <div style="background: rgba(255,255,255,0.05); padding: 25px; border-radius: 15px;">
                        <h3 style="margin-bottom: 15px;">Webstore Connection</h3>
                        
                        <div class="form-group">
                            <label>Webstore URL</label>
                            <input type="url" class="form-control" id="webstoreURL" value="https://mfhstore518.github.io/Mfh-Store.id/">
                        </div>
                        
                        <div class="form-group">
                            <label>Webhook URL</label>
                            <input type="text" class="form-control" id="webhookURL" value="https://mfh-vercel-dashboard.vercel.app/api/webhook" readonly>
                        </div>
                        
                        <button class="btn" onclick="testConnection()">
                            <i class="fas fa-plug"></i> Test Connection
                        </button>
                    </div>
                    
                    <button class="btn" style="margin-top: 30px;" onclick="saveSettings()">
                        <i class="fas fa-save"></i> Save All Settings
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- MODALS -->
    
    <!-- Change Password Modal -->
    <div id="changePasswordModal" class="modal">
        <div class="modal-content">
            <h2 style="margin-bottom: 20px;">üîë Change Password</h2>
            
            <div class="form-group">
                <label>Current Password</label>
                <input type="password" class="form-control" id="currentPassword">
            </div>
            
            <div class="form-group">
                <label>New Password</label>
                <input type="password" class="form-control" id="newPassword">
            </div>
            
            <div class="form-group">
                <label>Confirm New Password</label>
                <input type="password" class="form-control" id="confirmPassword">
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn" onclick="changePassword()">
                    <i class="fas fa-key"></i> Change Password
                </button>
                <button class="btn" onclick="hideModal('changePasswordModal')" style="background: #666;">
                    Cancel
                </button>
            </div>
        </div>
    </div>
    
    <!-- Add User Modal -->
    <div id="addUserModal" class="modal">
        <div class="modal-content">
            <h2 style="margin-bottom: 20px;">‚ûï Add New User</h2>
            
            <div class="form-group">
                <label>Username</label>
                <input type="text" class="form-control" id="newUserUsername" placeholder="seller3">
            </div>
            
            <div class="form-group">
                <label>Password</label>
                <input type="text" class="form-control" id="newUserPassword" value="seller123">
            </div>
            
            <div class="form-group">
                <label>Role</label>
                <select class="form-control" id="newUserRole">
                    <option value="seller">Seller</option>
                    <option value="admin">Admin</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Shop Name</label>
                <input type="text" class="form-control" id="newUserShop" placeholder="Toko Digital">
            </div>
            
            <div class="form-group">
                <label>Phone Number</label>
                <input type="text" class="form-control" id="newUserPhone" placeholder="081234567890">
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn" onclick="addUser()">
                    <i class="fas fa-plus"></i> Add User
                </button>
                <button class="btn" onclick="hideModal('addUserModal')" style="background: #666;">
                    Cancel
                </button>
            </div>
        </div>
    </div>
    
    <!-- Add Order Modal -->
    <div id="addOrderModal" class="modal">
        <div class="modal-content">
            <h2 style="margin-bottom: 20px;">‚ûï Create New Order</h2>
            
            <div class="form-group">
                <label>Customer Name</label>
                <input type="text" class="form-control" id="orderCustomerName">
            </div>
            
            <div class="form-group">
                <label>Customer Phone</label>
                <input type="text" class="form-control" id="orderCustomerPhone">
            </div>
            
            <div class="form-group">
                <label>Product</label>
                <select class="form-control" id="orderProduct">
                    <option value="Rekening BCA">Rekening BCA</option>
                    <option value="E-Wallet DANA">E-Wallet DANA</option>
                    <option value="Rekening Malaysia">Rekening Malaysia</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Amount (Rp)</label>
                <input type="number" class="form-control" id="orderAmount" value="350000">
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn" onclick="createOrder()">
                    <i class="fas fa-check"></i> Create Order
                </button>
                <button class="btn" onclick="hideModal('addOrderModal')" style="background: #666;">
                    Cancel
                </button>
            </div>
        </div>
    </div>
    
    <!-- Notification Container -->
    <div id="notificationContainer"></div>
    
    <script>
        // ===========================================
        // DATABASE (Local Storage)
        // ===========================================
        const MFH_DATABASE = {
            // Initialize database
            init() {
                // Users database
                if (!localStorage.getItem('mfh_users')) {
                    const defaultUsers = [
                        {
                            id: 1,
                            username: 'admin',
                            password: 'admin123',
                            role: 'admin',
                            shop_name: 'MFH Store Admin',
                            phone: '081998593873',
                            status: 'active',
                            created_at: new Date().toISOString()
                        },
                        {
                            id: 2,
                            username: 'seller1',
                            password: 'seller123',
                            role: 'seller',
                            shop_name: 'Toko Digital VVIP',
                            phone: '081234567890',
                            status: 'active',
                            created_at: new Date().toISOString()
                        }
                    ];
                    localStorage.setItem('mfh_users', JSON.stringify(defaultUsers));
                }
                
                // Orders database
                if (!localStorage.getItem('mfh_orders')) {
                    const defaultOrders = [
                        {
                            id: 'MFH001',
                            customer_name: 'Budi Santoso',
                            customer_phone: '628123456789',
                            product: 'Rekening BCA',
                            amount: 350000,
                            status: 'completed',
                            seller_id: 2,
                            created_at: new Date().toISOString()
                        },
                        {
                            id: 'MFH002',
                            customer_name: 'Sari Dewi',
                            customer_phone: '628987654321',
                            product: 'E-Wallet DANA',
                            amount: 150000,
                            status: 'pending',
                            seller_id: 2,
                            created_at: new Date().toISOString()
                        }
                    ];
                    localStorage.setItem('mfh_orders', JSON.stringify(defaultOrders));
                }
                
                // Products database
                if (!localStorage.getItem('mfh_products')) {
                    const defaultProducts = [
                        {
                            id: 1,
                            name: 'Rekening BCA',
                            price: 350000,
                            category: 'bank_indonesia',
                            status: 'active'
                        },
                        {
                            id: 2,
                            name: 'E-Wallet DANA',
                            price: 150000,
                            category: 'ewallet',
                            status: 'active'
                        }
                    ];
                    localStorage.setItem('mfh_products', JSON.stringify(defaultProducts));
                }
                
                // Settings
                if (!localStorage.getItem('mfh_settings')) {
                    const defaultSettings = {
                        store_name: 'MFH STORE ID',
                        store_phone: '081998593873',
                        store_email: 'admin@mfhstore.id',
                        webstore_url: 'https://mfhstore518.github.io/Mfh-Store.id/',
                        webhook_url: 'https://mfh-vercel-dashboard.vercel.app/api/webhook'
                    };
                    localStorage.setItem('mfh_settings', JSON.stringify(defaultSettings));
                }
                
                console.log('‚úÖ Database initialized');
            },
            
            // Users
            getUsers() {
                return JSON.parse(localStorage.getItem('mfh_users') || '[]');
            },
            
            addUser(user) {
                const users = this.getUsers();
                user.id = users.length > 0 ? Math.max(...users.map(u => u.id)) + 1 : 1;
                user.created_at = new Date().toISOString();
                user.status = 'active';
                users.push(user);
                localStorage.setItem('mfh_users', JSON.stringify(users));
                return user;
            },
            
            updateUser(userId, updates) {
                const users = this.getUsers();
                const index = users.findIndex(u => u.id === userId);
                if (index !== -1) {
                    users[index] = { ...users[index], ...updates };
                    localStorage.setItem('mfh_users', JSON.stringify(users));
                    return users[index];
                }
                return null;
            },
            
            // Orders
            getOrders() {
                return JSON.parse(localStorage.getItem('mfh_orders') || '[]');
            },
            
            addOrder(order) {
                const orders = this.getOrders();
                order.id = 'MFH' + Date.now().toString().slice(-6);
                order.created_at = new Date().toISOString();
                order.status = 'pending';
                orders.push(order);
                localStorage.setItem('mfh_orders', JSON.stringify(orders));
                return order;
            },
            
            updateOrder(orderId, updates) {
                const orders = this.getOrders();
                const index = orders.findIndex(o => o.id === orderId);
                if (index !== -1) {
                    orders[index] = { ...orders[index], ...updates };
                    localStorage.setItem('mfh_orders', JSON.stringify(orders));
                    return orders[index];
                }
                return null;
            },
            
            // Products
            getProducts() {
                return JSON.parse(localStorage.getItem('mfh_products') || '[]');
            },
            
            // Settings
            getSettings() {
                return JSON.parse(localStorage.getItem('mfh_settings') || '{}');
            },
            
            updateSettings(updates) {
                const settings = this.getSettings();
                const newSettings = { ...settings, ...updates };
                localStorage.setItem('mfh_settings', JSON.stringify(newSettings));
                return newSettings;
            }
        };
        
        // ===========================================
        // AUTHENTICATION SYSTEM
        // ===========================================
        const MFH_AUTH = {
            currentUser: null,
            
            login(username, password) {
                const users = MFH_DATABASE.getUsers();
                const user = users.find(u => 
                    u.username === username && 
                    u.password === password && 
                    u.status === 'active'
                );
                
                if (user) {
                    this.currentUser = user;
                    localStorage.setItem('mfh_current_user', JSON.stringify(user));
                    return { success: true, user };
                }
                
                return { success: false, message: 'Invalid username or password' };
            },
            
            logout() {
                this.currentUser = null;
                localStorage.removeItem('mfh_current_user');
                showPage('login');
            },
            
            getCurrentUser() {
                if (!this.currentUser) {
                    const savedUser = localStorage.getItem('mfh_current_user');
                    if (savedUser) {
                        this.currentUser = JSON.parse(savedUser);
                    }
                }
                return this.currentUser;
            },
            
            isAdmin() {
                const user = this.getCurrentUser();
                return user && user.role === 'admin';
            },
            
            isSeller() {
                const user = this.getCurrentUser();
                return user && user.role === 'seller';
            }
        };
        
        // ===========================================
        // WEBHOOK SYSTEM - Connect to Webstore
        // ===========================================
        const MFH_WEBHOOK = {
            async sendToWebstore(orderData) {
                try {
                    const settings = MFH_DATABASE.getSettings();
                    const webhookURL = settings.webhook_url;
                    
                    if (!webhookURL) {
                        console.warn('No webhook URL configured');
                        return { success: false, message: 'Webhook URL not configured' };
                    }
                    
                    const response = await fetch(webhookURL, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            type: 'order',
                            source: 'dashboard',
                            data: orderData,
                            timestamp: new Date().toISOString()
                        })
                    });
                    
                    if (response.ok) {
                        const result = await response.json();
                        console.log('‚úÖ Order sent to webstore:', result);
                        return { success: true, data: result };
                    } else {
                        throw new Error(`HTTP ${response.status}`);
                    }
                } catch (error) {
                    console.error('‚ùå Error sending to webstore:', error);
                    return { success: false, message: error.message };
                }
            },
            
            async testConnection() {
                try {
                    const settings = MFH_DATABASE.getSettings();
                    const webhookURL = settings.webhook_url;
                    
                    if (!webhookURL) {
                        return { success: false, message: 'No webhook URL configured' };
                    }
                    
                    const response = await fetch(webhookURL.replace('/api/webhook', '/api/ping'), {
                        method: 'GET',
                        headers: {
                            'Accept': 'application/json'
                        }
                    });
                    
                    if (response.ok) {
                        return { success: true, message: 'Connection successful!' };
                    } else {
                        throw new Error(`HTTP ${response.status}`);
                    }
                } catch (error) {
                    return { success: false, message: `Connection failed: ${error.message}` };
                }
            }
        };
        
        // ===========================================
        // UI FUNCTIONS
        // ===========================================
        function showNotification(message, type = 'success', duration = 3000) {
            const container = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 20px;
                border-radius: 10px;
                color: white;
                font-weight: 600;
                z-index: 2000;
                animation: slideIn 0.3s;
                background: ${type === 'success' ? 'linear-gradient(45deg, #00ffaa, #00cc88)' : 'linear-gradient(45deg, #ff4444, #ff6666)'};
            `;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                notification.style.animation = 'slideIn 0.3s reverse';
                setTimeout(() => notification.remove(), 300);
            }, duration);
        }
        
        function showModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }
        
        function hideModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
        
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Hide login page if showing dashboard
            if (pageId !== 'login') {
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('dashboardLayout').style.display = 'block';
                
                // Show correct menu based on role
                if (MFH_AUTH.isAdmin()) {
                    document.getElementById('adminMenu').style.display = 'block';
                    document.getElementById('sellerMenu').style.display = 'none';
                } else if (MFH_AUTH.isSeller()) {
                    document.getElementById('adminMenu').style.display = 'none';
                    document.getElementById('sellerMenu').style.display = 'block';
                }
            } else {
                document.getElementById('loginPage').style.display = 'flex';
                document.getElementById('dashboardLayout').style.display = 'none';
            }
            
            // Show selected page
            document.getElementById(pageId + 'Page').classList.add('active');
            
            // Update menu active state
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('onclick')?.includes(pageId)) {
                    item.classList.add('active');
                }
            });
            
            // Load page data
            if (pageId === 'dashboard' || pageId === 'sellerDashboard') {
                loadDashboardData();
            } else if (pageId === 'users') {
                loadUsersTable();
            } else if (pageId === 'orders') {
                loadOrders('all');
            } else if (pageId === 'settings') {
                loadSettings();
            }
        }
        
        // ===========================================
        // LOGIN FUNCTION
        // ===========================================
        function login() {
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;
            
            const result = MFH_AUTH.login(username, password);
            
            if (result.success) {
                // Update UI with user info
                document.getElementById('userName').textContent = result.user.username;
                document.getElementById('userShop').textContent = result.user.shop_name;
                document.getElementById('userRole').textContent = result.user.role;
                
                // Show dashboard
                showPage(MFH_AUTH.isAdmin() ? 'dashboard' : 'sellerDashboard');
                
                showNotification('Login successful!', 'success');
            } else {
                showNotification(result.message, 'error');
            }
        }
        
        function logout() {
            MFH_AUTH.logout();
            showNotification('Logged out successfully', 'success');
        }
        
        // ===========================================
        // DASHBOARD FUNCTIONS
        // ===========================================
        function loadDashboardData() {
            const orders = MFH_DATABASE.getOrders();
            const users = MFH_DATABASE.getUsers();
            const products = MFH_DATABASE.getProducts();
            
            // Calculate stats
            const today = new Date().toDateString();
            const todayOrders = orders.filter(o => 
                new Date(o.created_at).toDateString() === today
            );
            
            const completedOrders = orders.filter(o => o.status === 'completed');
            const totalRevenue = completedOrders.reduce((sum, o) => sum + o.amount, 0);
            const todayRevenue = todayOrders
                .filter(o => o.status === 'completed')
                .reduce((sum, o) => sum + o.amount, 0);
            
            const activeSellers = users.filter(u => u.role === 'seller' && u.status === 'active');
            const activeProducts = products.filter(p => p.status === 'active');
            
            // Update admin dashboard
            document.getElementById('totalOrders').textContent = orders.length;
            document.getElementById('todayOrders').textContent = todayOrders.length;
            document.getElementById('totalRevenue').textContent = 'Rp ' + totalRevenue.toLocaleString('id-ID');
            document.getElementById('todayRevenue').textContent = 'Rp ' + todayRevenue.toLocaleString('id-ID');
            document.getElementById('totalSellers').textContent = activeSellers.length;
            document.getElementById('totalProducts').textContent = products.length;
            document.getElementById('activeProducts').textContent = activeProducts.length;
            
            // Update recent orders table
            const recentOrdersTable = document.getElementById('recentOrdersTable');
            recentOrdersTable.innerHTML = '';
            
            orders.slice(0, 5).forEach(order => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${order.id}</td>
                    <td>${order.customer_name}</td>
                    <td>Rp ${order.amount.toLocaleString('id-ID')}</td>
                    <td><span class="status-badge status-${order.status}">${order.status}</span></td>
                `;
                recentOrdersTable.appendChild(row);
            });
            
            // Update seller dashboard if applicable
            if (MFH_AUTH.isSeller()) {
                const currentUser = MFH_AUTH.getCurrentUser();
                const sellerOrders = orders.filter(o => o.seller_id === currentUser.id);
                const sellerCompletedOrders = sellerOrders.filter(o => o.status === 'completed');
                const sellerRevenue = sellerCompletedOrders.reduce((sum, o) => sum + o.amount, 0);
                const sellerTodayOrders = sellerOrders.filter(o => 
                    new Date(o.created_at).toDateString() === today
                );
                const sellerTodayRevenue = sellerTodayOrders
                    .filter(o => o.status === 'completed')
                    .reduce((sum, o) => sum + o.amount, 0);
                
                document.getElementById('sellerOrders').textContent = sellerOrders.length;
                document.getElementById('sellerPending').textContent = sellerOrders.filter(o => o.status === 'pending').length;
                document.getElementById('sellerRevenue').textContent = 'Rp ' + sellerRevenue.toLocaleString('id-ID');
                document.getElementById('sellerTodayRevenue').textContent = 'Rp ' + sellerTodayRevenue.toLocaleString('id-ID');
                
                // Update seller orders table
                const sellerOrdersTable = document.getElementById('sellerOrdersTable');
                sellerOrdersTable.innerHTML = '';
                
                sellerOrders.slice(0, 5).forEach(order => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${order.id}</td>
                        <td>${order.customer_name}</td>
                        <td>${order.product}</td>
                        <td><span class="status-badge status-${order.status}">${order.status}</span></td>
                        <td>
                            <button class="btn" style="padding: 5px 10px; font-size: 0.8rem;" onclick="updateOrderStatus('${order.id}', 'processing')">
                                Process
                            </button>
                        </td>
                    `;
                    sellerOrdersTable.appendChild(row);
                });
            }
        }
        
        // ===========================================
        // USER MANAGEMENT
        // ===========================================
        function loadUsersTable() {
            const users = MFH_DATABASE.getUsers();
            const usersTable = document.getElementById('usersTable');
            usersTable.innerHTML = '';
            
            users.forEach(user => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${user.id}</td>
                    <td>${user.username}</td>
                    <td>${user.role}</td>
                    <td>${user.shop_name}</td>
                    <td>${user.phone}</td>
                    <td><span style="color: ${user.status === 'active' ? 'var(--success)' : 'var(--danger)'}">${user.status}</span></td>
                    <td>
                        <button class="btn" style="padding: 5px 10px; font-size: 0.8rem; margin-right: 5px;" onclick="editUser(${user.id})">
                            Edit
                        </button>
                        <button class="btn" style="padding: 5px 10px; font-size: 0.8rem; background: var(--danger);" onclick="deleteUser(${user.id})">
                            Delete
                        </button>
                    </td>
                `;
                usersTable.appendChild(row);
            });
        }
        
        function addUser() {
            const username = document.getElementById('newUserUsername').value;
            const password = document.getElementById('newUserPassword').value;
            const role = document.getElementById('newUserRole').value;
            const shop = document.getElementById('newUserShop').value;
            const phone = document.getElementById('newUserPhone').value;
            
            if (!username || !password) {
                showNotification('Username and password are required', 'error');
                return;
            }
            
            const newUser = {
                username,
                password,
                role,
                shop_name: shop,
                phone,
                status: 'active'
            };
            
            MFH_DATABASE.addUser(newUser);
            hideModal('addUserModal');
            showNotification('User added successfully', 'success');
            loadUsersTable();
        }
        
        // ===========================================
        // ORDER MANAGEMENT
        // ===========================================
        function loadOrders(filter = 'all') {
            let orders = MFH_DATABASE.getOrders();
            
            if (filter !== 'all') {
                orders = orders.filter(o => o.status === filter);
            }
            
            const ordersTable = document.getElementById('ordersTable');
            ordersTable.innerHTML = '';
            
            orders.forEach(order => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${order.id}</td>
                    <td>${order.customer_name}</td>
                    <td>${order.product}</td>
                    <td>Rp ${order.amount.toLocaleString('id-ID')}</td>
                    <td><span class="status-badge status-${order.status}">${order.status}</span></td>
                    <td>${new Date(order.created_at).toLocaleDateString('id-ID')}</td>
                    <td>
                        <button class="btn" style="padding: 5px 10px; font-size: 0.8rem;" onclick="updateOrderStatus('${order.id}', 'processing')">
                            Process
                        </button>
                        <button class="btn" style="padding: 5px 10px; font-size: 0.8rem; background: var(--success);" onclick="updateOrderStatus('${order.id}', 'completed')">
                            Complete
                        </button>
                    </td>
                `;
                ordersTable.appendChild(row);
            });
        }
        
        function createOrder() {
            const customerName = document.getElementById('orderCustomerName').value;
            const customerPhone = document.getElementById('orderCustomerPhone').value;
            const product = document.getElementById('orderProduct').value;
            const amount = parseInt(document.getElementById('orderAmount').value);
            
            if (!customerName || !customerPhone || !product) {
                showNotification('Please fill all fields', 'error');
                return;
            }
            
            const currentUser = MFH_AUTH.getCurrentUser();
            
            const newOrder = {
                customer_name: customerName,
                customer_phone: customerPhone,
                product: product,
                amount: amount,
                seller_id: currentUser.id,
                status: 'pending'
            };
            
            const order = MFH_DATABASE.addOrder(newOrder);
            
            // Send to webstore via webhook
            MFH_WEBHOOK.sendToWebstore(order).then(result => {
                if (result.success) {
                    showNotification('Order created and sent to webstore!', 'success');
                } else {
                    showNotification('Order created (webstore sync failed)', 'warning');
                }
            });
            
            hideModal('addOrderModal');
            loadDashboardData();
        }
        
        function updateOrderStatus(orderId, status) {
            MFH_DATABASE.updateOrder(orderId, { status });
            showNotification(`Order ${orderId} status updated to ${status}`, 'success');
            loadDashboardData();
            loadOrders('all');
        }
        
        // ===========================================
        // SETTINGS
        // ===========================================
        function loadSettings() {
            const settings = MFH_DATABASE.getSettings();
            
            document.getElementById('storeName').value = settings.store_name || '';
            document.getElementById('storePhone').value = settings.store_phone || '';
            document.getElementById('storeEmail').value = settings.store_email || '';
            document.getElementById('webstoreURL').value = settings.webstore_url || '';
            document.getElementById('webhookURL').value = settings.webhook_url || '';
        }
        
        function saveSettings() {
            const settings = {
                store_name: document.getElementById('storeName').value,
                store_phone: document.getElementById('storePhone').value,
                store_email: document.getElementById('storeEmail').value,
                webstore_url: document.getElementById('webstoreURL').value,
                webhook_url: document.getElementById('webhookURL').value
            };
            
            MFH_DATABASE.updateSettings(settings);
            showNotification('Settings saved successfully', 'success');
        }
        
        function testConnection() {
            showNotification('Testing connection...', 'success');
            
            MFH_WEBHOOK.testConnection().then(result => {
                if (result.success) {
                    showNotification('‚úÖ Connection successful! Webstore is connected.', 'success');
                } else {
                    showNotification(`‚ùå ${result.message}`, 'error');
                }
            });
        }
        
        // ===========================================
        // PASSWORD CHANGE
        // ===========================================
        function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            const currentUser = MFH_AUTH.getCurrentUser();
            
            if (currentUser.password !== currentPassword) {
                showNotification('Current password is incorrect', 'error');
                return;
            }
            
            if (newPassword !== confirmPassword) {
                showNotification('New passwords do not match', 'error');
                return;
            }
            
            if (newPassword.length < 6) {
                showNotification('Password must be at least 6 characters', 'error');
                return;
            }
            
            MFH_DATABASE.updateUser(currentUser.id, { password: newPassword });
            hideModal('changePasswordModal');
            showNotification('Password changed successfully', 'success');
            
            // Clear password fields
            document.getElementById('currentPassword').value = '';
            document.getElementById('newPassword').value = '';
            document.getElementById('confirmPassword').value = '';
        }
        
        // ===========================================
        // INITIALIZATION
        // ===========================================
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize database
            MFH_DATABASE.init();
            
            // Check if user is already logged in
            const currentUser = MFH_AUTH.getCurrentUser();
            if (currentUser) {
                // Update UI with user info
                document.getElementById('userName').textContent = currentUser.username;
                document.getElementById('userShop').textContent = currentUser.shop_name;
                document.getElementById('userRole').textContent = currentUser.role;
                
                // Show dashboard
                showPage(MFH_AUTH.isAdmin() ? 'dashboard' : 'sellerDashboard');
            } else {
                showPage('login');
            }
            
            // Auto-save function
            setInterval(() => {
                console.log('Auto-saving data...');
                // Data already saved in localStorage automatically
            }, 30000); // Every 30 seconds
            
            // Initial data load
            loadDashboardData();
        });
    </script>
</body>
</html>
